# SQL脚本分析

### 配置文件的加载顺序

1. Spring Boot 首先加载 `application.yaml`。
2. 根据激活的 profile，再加载对应的配置文件，例如 `application-local.yaml`。
3. 后加载的配置文件会覆盖先加载的配置文件中相同的配置项。

### schema-h2.sql + data-h2.sql

[H2数据库](SQL%E8%84%9A%E6%9C%AC%E5%88%86%E6%9E%90%20a71f321f83ba4dd3b1e1f2d3b112b2e4/H2%E6%95%B0%E6%8D%AE%E5%BA%93%202f2a60cfaf024a5a88d6516b7982a66a.md)

### schema-mysql.sql + data-mysql.sql

- 经检查除了部分语言差异内容完全一致

### mysql-update.sql （原有数据库更新参考）

- 说明：用于对现有的数据库架构进行变更和更新。该文件说明了在不同时间点对数据库结构所做的各种修改，包括增加新表、修改现有表的列、删除列、更新数据等。这通常用于跟踪和执行数据库架构的迭代和演变，以支持新功能和需求。
    
    具体内容包括：
    
    1. **增加和删除列**：
        - 增加新列，如 `status`, `description`, `is_publish` 等。
        - 删除不再需要的列，如 `entity`。
    2. **修改列属性**：
        - 改变列的数据类型和名称，如将 `domain_id` 改为 `model_id`。
        - 更新列的默认值和注释。
    3. **创建新表**：
        - 创建新表，如 `s2_model_rela`, `s2_sys_parameter`, `s2_term`, `s2_chat_memory` 等。
    4. **删除和重命名表**：
        - 删除不再使用的表。
        - 重命名表，如将 `s2_view` 重命名为 `s2_data_set`。
    5. **更新数据**：
        - 执行 `UPDATE` 语句来修改表中的现有数据。
- 用途：
    1. **数据库迁移**：
    当应用程序需要新的功能或改进现有功能时，数据库架构可能需要更新。这个文件提供了一系列 SQL 语句，可以顺序执行，以将现有数据库迁移到新的架构版本。
    2. **版本控制**：
    通过记录每次修改的具体 SQL 语句，可以清晰地了解数据库架构的变化历史。这有助于在不同环境（如开发、测试、生产）中保持一致性。
    3. **快速部署**：
    当部署新版本的应用程序时，可以使用该文件快速更新数据库结构，以确保新功能能够正常运行。